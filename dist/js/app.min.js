(function(){"use strict";var e=Stapes.subclass(),t={init:function(){var t=new e;return setTimeout(function(){var e={filter:"football/england/premier_league/",args:{}};t.emit("ready",e)},100),t},getData:function(t,a){var n=new e,o=new XMLHttpRequest;return o.open("GET","mockdata.json"),o.send(null),o.onreadystatechange=function(){4===o.readyState&&200===o.status&&n.emit("change",JSON.parse(o.responseText))},n}};rivets.formatters.translate=function(e){return e};var a=function(e,t){var a={id:e.id,date:e.date,inHome:e.homeTeam===t,homeTeam:e.homeTeam,awayTeam:e.awayTeam,homeScore:e.result.homeScore,awayScore:e.result.awayScore,result:"lose"},n=a.date,o=n.getUTCDate()+"";1===o.length&&(o="0"+o);var r=n.getUTCMonth()+1+"";1===r.length&&(r="0"+r),a.dateText=o+"/"+r+"/"+n.getUTCFullYear();var s=e.result;return a.inHome?(a.teamScore=s.homeScore,a.opponentScore=s.awayScore,a.opponentName=e.awayTeam):(a.teamScore=s.awayScore,a.opponentScore=s.homeScore,a.opponentName=e.homeTeam),s.homeScore===s.awayScore?a.result="draw":(a.inHome&&s.homeScore>s.awayScore||!a.inHome&&s.awayScore>s.homeScore)&&(a.result="win"),a.tooltipText="vs "+a.opponentName+" - "+a.teamScore+"x"+a.opponentScore,a},n=function(e,t,a){if(e.length>=a)return!1;var n=e.filter(function(e){return t.id===e.id}).length>0;return!n},o=function(e){var t=0;return e.forEach(function(e){"win"===e.result?t+=20:"draw"===e.result&&(t+=10)}),t/(20*e.length)},r=function(e,t){var r=[];return e.forEach(function(e){var s=[],i=[],c=[];e.matchHistory.forEach(function(e,t){e.date=new Date(e.date)}),e.matchHistory.sort(function(e,t){return e.date.getTime()>t.date.getTime()?1:-1}),e.matchHistory.forEach(function(o,r){var m=a(o,e.name);n(s,m,t)&&s.push(m),m.inHome&&n(i,m,t)&&i.push(m),!m.inHome&&n(c,m,t)&&c.push(m)}),r.push({name:e.name,performance:o(s),detailed:!1,matchHistory:s,matchHistoryHome:i,matchHistoryAway:c})}),r},s=Stapes.subclass({constructor:function(e){this.scope={},t.init().on("ready",function(e){this.model=t.getData("someType",e.filter),this.model.on("change",function(e){this.scope.args=Object.assign({title:"Football - Team Performance Indicator",numberMatchesPerTeam:6,listLimit:3},e.args),this.scope.teams=r(e.tournaments[0].teams,this.scope.numberMatchesPerTeam)}.bind(this))}.bind(this)),this.view=rivets.bind(document.getElementById("main"),this.scope),this.view.binders["box-css-class"]=this.boxCssClass},boxCssClass:function(e,t){e.classList.add("kw-match-"+t)}});new s}).call(this);