!function(){"use strict";var e=function(e,t){var o={id:e.id,date:e.date,inHome:e.homeTeam===t,homeTeam:e.homeTeam,awayTeam:e.awayTeam,homeScore:e.result.homeScore,awayScore:e.result.awayScore,result:"lose"},a=o.date,n=a.getUTCDate()+"";1===n.length&&(n="0"+n);var r=a.getUTCMonth()+1+"";1===r.length&&(r="0"+r),o.dateText=n+"/"+r+"/"+a.getUTCFullYear();var i=e.result;return o.inHome?(o.teamScore=i.homeScore,o.opponentScore=i.awayScore,o.opponentName=e.awayTeam):(o.teamScore=i.awayScore,o.opponentScore=i.homeScore,o.opponentName=e.homeTeam),i.homeScore===i.awayScore?o.result="draw":(o.inHome&&i.homeScore>i.awayScore||!o.inHome&&i.awayScore>i.homeScore)&&(o.result="win"),o.tooltipText="vs "+o.opponentName+" - "+o.teamScore+"x"+o.opponentScore,o},t=function(e,t,o){if(e.length>=o)return!1;var a=e.filter(function(e){return t.id===e.id}).length>0;return!a},o=function(e){var t=0;return e.forEach(function(e){"win"===e.result?t+=20:"draw"===e.result&&(t+=10)}),t/(20*e.length)},a=function(a,n){var r=[];return a.forEach(function(a){var i=[],s=[],c=[];a.matchHistory.forEach(function(e,t){e.date=new Date(e.date)}),a.matchHistory.sort(function(e,t){return e.date.getTime()>t.date.getTime()?1:-1}),a.matchHistory.forEach(function(o,r){var h=e(o,a.name);t(i,h,n)&&i.push(h),h.inHome&&t(s,h,n)&&s.push(h),!h.inHome&&t(c,h,n)&&c.push(h)}),r.push({name:a.name,performance:o(i),detailed:!1,matchHistory:i,matchHistoryHome:s,matchHistoryAway:c})}),r},n=Stapes.subclass({constructor:function(e){this.scope={},CoreLibrary.init().then(function(e){this.scope.args={title:"Football - Team Performance Indicator",numberMatchesPerTeam:6},Object.keys(e).forEach(function(t){this.scope.args[t]=e[t]}.bind(this)),CoreLibrary.widgetModule.enableWidgetTransition(!0),CoreLibrary.getData("mockdata.json").then(function(e){this.scope.teams=a(e.tournaments[0].teams,this.scope.numberMatchesPerTeam),this.scope.teams.forEach(function(e){sightglass(e,"detailed",this.adjustHeight.bind(this))}.bind(this)),this.adjustHeight()}.bind(this))}.bind(this))["catch"](function(e){}),this.view=rivets.bind(document.getElementById("main"),this.scope),this.view.binders["box-css-class"]=this.boxCssClass},boxCssClass:function(e,t){e.classList.add("kw-match-"+t)},adjustHeight:function(){var e=40,t=85,o=45,a=e;this.scope.teams.forEach(function(e){a+=e.detailed?t+e.matchHistory.length*o:t}),CoreLibrary.widgetModule.setWidgetHeight(a+1)}});new n}();